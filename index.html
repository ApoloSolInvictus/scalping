<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Invictus Capital | Crypto Assets</title>
    
    <!-- Librerías -->
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="https://unpkg.com/@phosphor-icons/web"></script>
    
    <!-- React Core -->
    <script crossorigin src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>

    <!-- Firebase SDK -->
    <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-auth-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-firestore-compat.js"></script>

    <link href="https://fonts.googleapis.com/css2?family=Manrope:wght@300;400;600;700&display=swap" rel="stylesheet">

    <script>
        tailwind.config = {
            theme: {
                extend: {
                    fontFamily: { sans: ['Manrope', 'sans-serif'] },
                    colors: {
                        brand: {
                            dark: '#0f172a',
                            primary: '#2563eb', 
                            accent: '#0ea5e9',
                            bg: '#f8fafc'
                        }
                    }
                }
            }
        }
    </script>
    <style>
        body { background-color: #f8fafc; }
        .glass-panel { background: white; border: 1px solid #e2e8f0; box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.05); }
        .sidebar-link.active { background-color: #eff6ff; color: #2563eb; border-right: 3px solid #2563eb; }
        .asset-card:hover { transform: translateY(-3px); box-shadow: 0 10px 15px -3px rgba(0, 0, 0, 0.1); }
        .fade-in { animation: fadeIn 0.5s ease-in; }
        @keyframes fadeIn { from { opacity: 0; } to { opacity: 1; } }
    </style>
</head>
<body class="text-slate-800 h-screen overflow-hidden">
    <div id="root"></div>

    <script type="text/babel">
        const { useState, useEffect, useRef } = React;

        // --- CONFIGURACIÓN FIREBASE (SOBERANO: PEGAR LLAVES AQUÍ) ---
        const firebaseConfig = {
            apiKey: "AIzaSyDrp6Dx5gADsFsQpEE5E5buXXEAqu9-YdA", 
            authDomain: "scalping-f433d.firebaseapp.com",
            projectId: "scalping-f433d",
            storageBucket: "scalping-f433d.firebasestorage.app",
            messagingSenderId: "G-D6DL9FET3Q",
            appId: "1:1055317099279:web:48ee6331b8e73d3325747a"
        };

        // Inicialización Segura
        let isFirebaseActive = false;
        if (firebaseConfig.apiKey !== "PON_TU_API_KEY_AQUI") {
            if (!firebase.apps.length) firebase.initializeApp(firebaseConfig);
            isFirebaseActive = true;
        }

        // --- COMPONENTES ---

        // 1. LOGIN (Estilo Corporativo)
        const LoginScreen = ({ onLoginSuccess }) => {
            const [email, setEmail] = useState("");
            const [password, setPassword] = useState("");
            const [loading, setLoading] = useState(false);
            const [error, setError] = useState("");

            const handleLogin = async (e) => {
                e.preventDefault();
                setLoading(true);
                setError("");
                
                try {
                    if (isFirebaseActive) {
                        const userCredential = await firebase.auth().signInWithEmailAndPassword(email, password);
                        onLoginSuccess(userCredential.user);
                    } else {
                        // Simulación para Demo
                        setTimeout(() => {
                            if(email.length > 3) onLoginSuccess({ email, uid: "sim-uid" });
                            else { setError("Credenciales inválidas (Demo)"); setLoading(false); }
                        }, 1000);
                    }
                } catch (err) {
                    setError("Error de acceso: Verifica tus credenciales.");
                    setLoading(false);
                }
            };

            return (
                <div className="min-h-screen flex items-center justify-center bg-slate-50 fade-in">
                    <div className="bg-white p-10 rounded-2xl shadow-xl w-full max-w-md border border-slate-100">
                        <div className="text-center mb-8">
                            <div className="w-12 h-12 bg-brand-primary rounded-xl flex items-center justify-center text-white font-bold text-2xl mx-auto mb-4">I</div>
                            <h1 className="text-2xl font-bold text-slate-800">Invictus Capital</h1>
                            <p className="text-slate-400 text-sm">Banca Privada de Criptoactivos</p>
                        </div>
                        <form onSubmit={handleLogin} className="space-y-5">
                            <div>
                                <label className="text-xs font-bold text-slate-500 uppercase">Email</label>
                                <input type="email" value={email} onChange={e=>setEmail(e.target.value)} className="w-full border border-slate-300 rounded-lg p-3 mt-1 focus:ring-2 focus:ring-brand-primary focus:border-transparent outline-none transition" placeholder="inversor@capital.com" />
                            </div>
                            <div>
                                <label className="text-xs font-bold text-slate-500 uppercase">Contraseña</label>
                                <input type="password" value={password} onChange={e=>setPassword(e.target.value)} className="w-full border border-slate-300 rounded-lg p-3 mt-1 focus:ring-2 focus:ring-brand-primary focus:border-transparent outline-none transition" placeholder="••••••••" />
                            </div>
                            {error && <div className="text-red-500 text-xs bg-red-50 p-2 rounded">{error}</div>}
                            <button disabled={loading} className="w-full py-3 bg-slate-900 text-white font-bold rounded-lg hover:bg-brand-primary transition shadow-lg">
                                {loading ? "Accediendo..." : "Iniciar Sesión"}
                            </button>
                        </form>
                    </div>
                </div>
            );
        };

        // 2. DASHBOARD PRINCIPAL
        const Dashboard = ({ user, onLogout }) => {
            const [view, setView] = useState('overview'); // overview, marketplace, portfolio
            const [showDeposit, setShowDeposit] = useState(false);

            // Gráficos (Effect Hook para Chart.js)
            useEffect(() => {
                if (view === 'overview') {
                    const ctx = document.getElementById('performanceChart');
                    if (ctx) {
                        // Destruir gráfico anterior si existe para evitar duplicados
                        const existingChart = Chart.getChart(ctx);
                        if (existingChart) existingChart.destroy();

                        new Chart(ctx, {
                            type: 'line',
                            data: {
                                labels: ['Ene', 'Feb', 'Mar', 'Abr', 'May', 'Jun'],
                                datasets: [{
                                    label: 'Valor del Portafolio (USDT)',
                                    data: [50000, 52000, 48000, 55000, 62000, 68500],
                                    borderColor: '#2563eb',
                                    backgroundColor: 'rgba(37, 99, 235, 0.05)',
                                    fill: true,
                                    tension: 0.4
                                }]
                            },
                            options: { responsive: true, maintainAspectRatio: false, plugins: { legend: { display: false } }, scales: { x: { display: false }, y: { display: false } } }
                        });
                    }
                }
            }, [view]);

            return (
                <div className="flex h-screen overflow-hidden fade-in">
                    {/* SIDEBAR */}
                    <aside className="w-64 bg-white border-r border-slate-200 flex flex-col z-20 hidden md:flex">
                        <div className="h-20 flex items-center px-8 border-b border-slate-50">
                            <div className="w-8 h-8 bg-brand-primary rounded-lg flex items-center justify-center text-white font-bold text-xl mr-3">I</div>
                            <span className="font-bold text-lg tracking-tight text-slate-800">INVICTUS <span className="text-slate-400 font-normal">CAP</span></span>
                        </div>
                        <nav className="flex-1 py-6 px-3 space-y-1">
                            <button onClick={() => setView('overview')} className={`w-full flex items-center gap-3 px-4 py-3 text-sm font-semibold rounded-lg transition ${view === 'overview' ? 'bg-blue-50 text-brand-primary' : 'text-slate-600 hover:bg-slate-50'}`}>
                                <i className="ph ph-squares-four text-xl"></i> Resumen
                            </button>
                            <button onClick={() => setView('marketplace')} className={`w-full flex items-center gap-3 px-4 py-3 text-sm font-semibold rounded-lg transition ${view === 'marketplace' ? 'bg-blue-50 text-brand-primary' : 'text-slate-600 hover:bg-slate-50'}`}>
                                <i className="ph ph-trend-up text-xl"></i> Mercado Cripto
                            </button>
                            <button onClick={() => setView('portfolio')} className={`w-full flex items-center gap-3 px-4 py-3 text-sm font-semibold rounded-lg transition ${view === 'portfolio' ? 'bg-blue-50 text-brand-primary' : 'text-slate-600 hover:bg-slate-50'}`}>
                                <i className="ph ph-chart-pie-slice text-xl"></i> Mis Activos
                            </button>
                        </nav>
                        <div className="p-4">
                            <div className="bg-slate-900 rounded-xl p-4 text-white">
                                <p className="text-xs text-slate-400 mb-1">Saldo Disponible</p>
                                <p className="font-bold text-lg">$15,400.00 <span className="text-xs text-slate-500">USDT</span></p>
                                <button onClick={() => setShowDeposit(true)} className="mt-3 w-full bg-brand-primary hover:bg-blue-600 py-2 rounded-lg text-xs font-bold transition">Depositar</button>
                            </div>
                        </div>
                    </aside>

                    {/* MAIN CONTENT */}
                    <main className="flex-1 flex flex-col relative bg-slate-50/50">
                        {/* Header */}
                        <header className="h-20 bg-white border-b border-slate-200 flex items-center justify-between px-8">
                            <h2 className="text-xl font-bold text-slate-800">
                                {view === 'overview' && 'Visión General'}
                                {view === 'marketplace' && 'Oportunidades Cripto'}
                                {view === 'portfolio' && 'Mi Portafolio'}
                            </h2>
                            <div className="flex items-center gap-4">
                                <div className="text-right hidden sm:block">
                                    <p className="text-sm font-bold text-slate-800">Usuario VIP</p>
                                    <p className="text-xs text-green-600 flex items-center justify-end gap-1"><span className="w-1.5 h-1.5 rounded-full bg-green-500"></span> Verificado</p>
                                </div>
                                <button onClick={onLogout} className="p-2 text-slate-400 hover:text-red-500 transition" title="Salir"><i className="ph ph-sign-out text-xl"></i></button>
                            </div>
                        </header>

                        <div className="flex-1 overflow-y-auto p-8">
                            
                            {/* VIEW: OVERVIEW */}
                            {view === 'overview' && (
                                <div className="space-y-8 animate-fadeIn">
                                    {/* Stats */}
                                    <div className="grid grid-cols-1 md:grid-cols-3 gap-6">
                                        <div className="glass-panel p-6 rounded-2xl">
                                            <p className="text-sm text-slate-500 font-medium mb-1">Equity Total</p>
                                            <h3 className="text-3xl font-bold text-slate-900">$68,500.00</h3>
                                            <span className="text-green-600 text-xs font-bold bg-green-50 px-2 py-1 rounded-full mt-2 inline-block">+14.2% este mes</span>
                                        </div>
                                        <div className="glass-panel p-6 rounded-2xl">
                                            <p className="text-sm text-slate-500 font-medium mb-1">PnL Realizado</p>
                                            <h3 className="text-3xl font-bold text-green-600">+$4,250.00</h3>
                                            <p className="text-xs text-slate-400 mt-2">Último cierre: BTC/USDT</p>
                                        </div>
                                        <div className="glass-panel p-6 rounded-2xl">
                                            <p className="text-sm text-slate-500 font-medium mb-1">Posiciones Abiertas</p>
                                            <h3 className="text-3xl font-bold text-slate-900">3</h3>
                                            <button onClick={() => setView('portfolio')} className="text-xs font-bold text-brand-primary mt-2 hover:underline">Ver detalles &rarr;</button>
                                        </div>
                                    </div>

                                    {/* Chart */}
                                    <div className="glass-panel p-6 rounded-2xl">
                                        <h3 className="font-bold text-lg text-slate-800 mb-6">Rendimiento Histórico</h3>
                                        <div className="h-72 w-full">
                                            <canvas id="performanceChart"></canvas>
                                        </div>
                                    </div>
                                </div>
                            )}

                            {/* VIEW: MARKETPLACE (CRYPTO PAIRS) */}
                            {view === 'marketplace' && (
                                <div className="space-y-6 animate-fadeIn">
                                    <div className="grid md:grid-cols-2 lg:grid-cols-3 gap-6">
                                        {/* BTC Asset */}
                                        <div className="glass-panel rounded-2xl overflow-hidden hover:shadow-lg transition group">
                                            <div className="h-32 bg-slate-900 flex items-center justify-center relative">
                                                <i className="ph ph-currency-btc text-6xl text-yellow-500"></i>
                                                <span className="absolute top-4 right-4 bg-green-500/20 text-green-400 text-xs font-bold px-2 py-1 rounded">+2.4%</span>
                                            </div>
                                            <div className="p-6">
                                                <div className="flex justify-between mb-2">
                                                    <h3 className="font-bold text-lg">Bitcoin Fund</h3>
                                                    <span className="text-slate-500 font-mono">BTC</span>
                                                </div>
                                                <p className="text-sm text-slate-500 mb-4">Exposición directa a Bitcoin con custodia en frío institucional.</p>
                                                <div className="flex justify-between items-center border-t border-slate-100 pt-4">
                                                    <span className="font-bold text-lg">$45,230.00</span>
                                                    <button className="bg-slate-900 text-white px-4 py-2 rounded-lg text-sm font-bold hover:bg-brand-primary transition">Comprar</button>
                                                </div>
                                            </div>
                                        </div>

                                        {/* ETH Asset */}
                                        <div className="glass-panel rounded-2xl overflow-hidden hover:shadow-lg transition group">
                                            <div className="h-32 bg-slate-900 flex items-center justify-center relative">
                                                <i className="ph ph-currency-eth text-6xl text-purple-500"></i>
                                                <span className="absolute top-4 right-4 bg-red-500/20 text-red-400 text-xs font-bold px-2 py-1 rounded">-1.1%</span>
                                            </div>
                                            <div className="p-6">
                                                <div className="flex justify-between mb-2">
                                                    <h3 className="font-bold text-lg">Ethereum Staking</h3>
                                                    <span className="text-slate-500 font-mono">ETH</span>
                                                </div>
                                                <p className="text-sm text-slate-500 mb-4">Genera rendimiento pasivo validando la red Ethereum 2.0.</p>
                                                <div className="flex justify-between items-center border-t border-slate-100 pt-4">
                                                    <span className="font-bold text-lg">$2,450.00</span>
                                                    <button className="bg-slate-900 text-white px-4 py-2 rounded-lg text-sm font-bold hover:bg-brand-primary transition">Comprar</button>
                                                </div>
                                            </div>
                                        </div>

                                        {/* SOL Asset */}
                                        <div className="glass-panel rounded-2xl overflow-hidden hover:shadow-lg transition group">
                                            <div className="h-32 bg-slate-900 flex items-center justify-center relative">
                                                <i className="ph ph-lightning text-6xl text-teal-400"></i>
                                                <span className="absolute top-4 right-4 bg-green-500/20 text-green-400 text-xs font-bold px-2 py-1 rounded">+5.8%</span>
                                            </div>
                                            <div className="p-6">
                                                <div className="flex justify-between mb-2">
                                                    <h3 className="font-bold text-lg">Solana High Speed</h3>
                                                    <span className="text-slate-500 font-mono">SOL</span>
                                                </div>
                                                <p className="text-sm text-slate-500 mb-4">Inversión en el ecosistema DeFi de Solana de alta frecuencia.</p>
                                                <div className="flex justify-between items-center border-t border-slate-100 pt-4">
                                                    <span className="font-bold text-lg">$102.50</span>
                                                    <button className="bg-slate-900 text-white px-4 py-2 rounded-lg text-sm font-bold hover:bg-brand-primary transition">Comprar</button>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            )}

                            {/* VIEW: PORTFOLIO */}
                            {view === 'portfolio' && (
                                <div className="animate-fadeIn">
                                    <div className="glass-panel rounded-2xl overflow-hidden">
                                        <table className="w-full text-left text-sm">
                                            <thead className="bg-slate-50 border-b border-slate-200">
                                                <tr>
                                                    <th className="p-4 font-bold text-slate-600">Activo</th>
                                                    <th className="p-4 font-bold text-slate-600">Cantidad</th>
                                                    <th className="p-4 font-bold text-slate-600">Valor Promedio</th>
                                                    <th className="p-4 font-bold text-slate-600">Valor Actual</th>
                                                    <th className="p-4 font-bold text-slate-600 text-right">PnL</th>
                                                </tr>
                                            </thead>
                                            <tbody className="divide-y divide-slate-100">
                                                <tr className="hover:bg-slate-50 transition">
                                                    <td className="p-4 font-bold flex items-center gap-2"><div className="w-2 h-2 rounded-full bg-yellow-500"></div> BTC</td>
                                                    <td className="p-4">0.55</td>
                                                    <td className="p-4 text-slate-500">$40,000</td>
                                                    <td className="p-4 font-mono">$45,230</td>
                                                    <td className="p-4 text-right text-green-600 font-bold">+$2,876.50</td>
                                                </tr>
                                                <tr className="hover:bg-slate-50 transition">
                                                    <td className="p-4 font-bold flex items-center gap-2"><div className="w-2 h-2 rounded-full bg-purple-500"></div> ETH</td>
                                                    <td className="p-4">10.0</td>
                                                    <td className="p-4 text-slate-500">$2,100</td>
                                                    <td className="p-4 font-mono">$2,450</td>
                                                    <td className="p-4 text-right text-green-600 font-bold">+$3,500.00</td>
                                                </tr>
                                            </tbody>
                                        </table>
                                    </div>
                                </div>
                            )}
                        </div>
                    </main>

                    {/* MODAL DE DEPÓSITO (SIMULACIÓN DE GATEWAY) */}
                    {showDeposit && (
                        <div className="fixed inset-0 bg-slate-900/80 z-50 flex items-center justify-center p-4 fade-in backdrop-blur-sm">
                            <div className="bg-white w-full max-w-md rounded-2xl p-6 shadow-2xl">
                                <div className="flex justify-between items-center mb-6">
                                    <h3 className="font-bold text-lg text-slate-800">Depositar Fondos</h3>
                                    <button onClick={() => setShowDeposit(false)} className="text-slate-400 hover:text-red-500"><i className="ph ph-x text-xl"></i></button>
                                </div>
                                
                                <div className="text-center mb-6">
                                    <div className="bg-white border-2 border-slate-200 inline-block p-2 rounded-xl mb-3">
                                        <img src="https://api.qrserver.com/v1/create-qr-code/?size=150x150&data=TB123456789InvictusCapitalUSDTAddress" alt="QR" />
                                    </div>
                                    <p className="text-xs text-slate-500 font-mono bg-slate-100 p-2 rounded break-all select-all cursor-pointer hover:bg-slate-200 transition">
                                        TB123456789InvictusCapitalUSDTAddress
                                    </p>
                                    <p className="text-[10px] text-slate-400 mt-2">Red: TRC20 (Tron) | Moneda: USDT</p>
                                </div>

                                <div className="space-y-3">
                                    <div className="p-3 bg-blue-50 rounded-lg text-xs text-blue-700 border border-blue-100">
                                        <i className="ph ph-info mr-1"></i>
                                        El saldo se acreditará automáticamente tras 3 confirmaciones de red.
                                    </div>
                                    <button onClick={() => {alert("Sistema de pago simulado. En producción, esto verifica la blockchain."); setShowDeposit(false);}} className="w-full py-3 bg-brand-primary text-white font-bold rounded-lg hover:bg-blue-600 transition">
                                        He realizado el pago
                                    </button>
                                </div>
                            </div>
                        </div>
                    )}
                </div>
            );
        };

        // 3. APP PRINCIPAL
        const App = () => {
            const [user, setUser] = useState(null);
            
            useEffect(() => {
                if(isFirebaseActive) {
                    const unsubscribe = firebase.auth().onAuthStateChanged(u => setUser(u || null));
                    return () => unsubscribe();
                }
            }, []);

            return (
                <React.Fragment>
                    {!user ? <LoginScreen onLoginSuccess={setUser} /> : <Dashboard user={user} onLogout={() => firebase.auth().signOut()} />}
                </React.Fragment>
            );
        };

        const root = ReactDOM.createRoot(document.getElementById('root'));
        root.render(<App />);
    </script>
</body>
</html>
